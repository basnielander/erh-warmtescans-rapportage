<div class="image-card">
  <div class="image-container">
    <img 
      *ngIf="imageUrl() && !isLoading() && !hasError()"
      [src]="imageUrl()!" 
      [alt]="image.name"
      [title]="image.name"
      class="image-thumbnail"
      loading="lazy"
      (click)="onImageClick($event)"
    />
    <div *ngIf="isLoading()" class="image-loading">
      <div class="spinner-small"></div>
      <p>Loading...</p>
    </div>
    <div *ngIf="hasError()" class="image-error">
      <p>âš ï¸ Failed to load</p>
    </div>
  </div>
  <div class="image-info">
    <div class="image-name" [title]="image.name">{{ image.name }}</div>
    <div class="image-meta">
      <span *ngIf="image.size" class="image-size">{{ formatFileSize(image.size) }}</span>
      <span *ngIf="image.modifiedTime" class="image-date">
        {{ image.modifiedTime | date:'short' }}
      </span>
    </div>

    <!-- View Mode -->
    <div *ngIf="!isEditing()" class="image-details">
      <div class="detail-item">
        <span class="detail-label">Location:</span>
        <span class="detail-value">{{ image.outdoor ? 'ğŸŒ¤ï¸ Outdoor' : 'ğŸ  Indoor' }}</span>
      </div>
      <div class="detail-item" *ngIf="image.comments">
        <span class="detail-label">Comments:</span>
        <span class="detail-value">{{ image.comments }}</span>
      </div>
    </div>

    <!-- Edit Mode -->
    <div *ngIf="isEditing()" class="image-edit-form">
      <div class="form-group">
        <label class="form-label">
          <input 
            type="checkbox" 
            [checked]="editOutdoor()"
            (change)="editOutdoor.set(!editOutdoor())"
            class="form-checkbox"
          />
          <span class="checkbox-label">{{ editOutdoor() ? 'ğŸŒ¤ï¸ Outdoor' : 'ğŸ  Indoor' }}</span>
        </label>
      </div>
      <div class="form-group">
        <label class="form-label" for="comments-{{image.id}}">Comments:</label>
        <textarea 
          id="comments-{{image.id}}"
          [value]="editComment()"
          (input)="editComment.set($any($event.target).value)"
          class="form-textarea"
          rows="3"
          placeholder="Add a comment about this image..."
        ></textarea>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="image-actions">
      <div *ngIf="!isEditing()" class="action-buttons">
        <button 
          class="btn-edit" 
          (click)="onEditClick($event)"
          title="Edit properties">
          âœï¸ Edit
        </button>
        <button 
          *ngIf="!image.excludeFromReport"
          class="btn-exclude" 
          (click)="onToggleExcludeClick($event)"
          title="Exclude from report">
          ğŸ—‘ï¸ Exclude
        </button>
        <button 
          *ngIf="image.excludeFromReport"
          class="btn-include" 
          (click)="onToggleExcludeClick($event)"
          title="Include in report">
          â†©ï¸ Include
        </button>
      </div>
      <div *ngIf="isEditing()" class="action-buttons">
        <button 
          class="btn-save" 
          (click)="onSaveClick($event)"
          title="Save changes">
          âœ… Save
        </button>
        <button 
          class="btn-cancel" 
          (click)="onCancelClick($event)"
          title="Cancel editing">
          âŒ Cancel
        </button>
      </div>
    </div>
  </div>
</div>
